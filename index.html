<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© - ÙØ¬Ø±ÙŒ ÙˆØºØ±ÙˆØ¨</title>
    <!-- Manifest Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ (Offline) -->
    <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22%D9%85%D8%B1%D8%A7%D8%AD%D9%84%20%D8%A7%D9%84%D9%81%D8%AC%D8%B1%20%D9%88%D8%A7%D9%84%D8%B4%D8%B1%D9%88%D9%82%22%2C%22short_name%22%3A%22%D8%A7%D9%84%D9%85%D8%B1%D8%A7%D8%AD%D9%84%22%2C%22start_url%22%3A%22.%2F%22%2C%22display%22%3A%22standalone%22%2C%22theme_color%22%3A%22%230a101c%22%2C%22background_color%22%3A%22%230a101c%22%7D">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Amiri', 'Tahoma', system-ui, sans-serif;
        }
        
        /* ØªØ«Ø¨ÙŠØª Ø§Ù„ØµÙØ­Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆÙ…Ù†Ø¹ Ø£ÙŠ Ø­Ø±ÙƒØ© */
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #0a101c;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            position: fixed;
            top: 0;
            left: 0;
        }

        .container {
            max-width: 1400px;
            width: 100%;
            height: 98%;
            max-height: 98vh;
            background: #0f1c2ef2;
            backdrop-filter: blur(8px);
            border-radius: min(3rem, 6vw) min(3rem, 6vw) min(2rem, 4vw) min(2rem, 4vw);
            box-shadow: 0 25px 50px #000000b0, 0 0 0 2px #4f72a0 inset, 0 0 30px #6b9bd4b0;
            overflow: hidden;
            border: 2px solid #dbb87c;
            display: flex;
            flex-direction: column;
        }

        .sky-panel {
            position: relative;
            width: 100%;
            flex: 0 0 auto;
            height: min(400px, 35vh);
            min-height: 250px;
            background: #0a1425;
            overflow: hidden;
            border-bottom: 4px solid #d4a259;
            box-shadow: 0 -10px 40px #000000 inset;
        }

        .horizon-line {
            position: absolute;
            bottom: 25%;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #e9cfa0, #fef7d4, #e9cfa0, transparent);
            box-shadow: 0 0 30px #fddea8;
            z-index: 30;
            border-radius: 2px;
        }

        .horizon-label {
            position: absolute;
            bottom: calc(25% - 30px);
            right: max(10px, 2%);
            background: #1f2b3ad9;
            color: #fee2b5;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: clamp(0.7rem, 2vw, 0.9rem);
            border: 1px solid #baa06a;
            backdrop-filter: blur(10px);
            z-index: 40;
            font-weight: 600;
            white-space: nowrap;
            pointer-events: none;
        }

        .sky-canvas, .stars-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        .sky-canvas { z-index: 10; }
        .stars-canvas { 
            z-index: 20;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .celestial-body {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: clamp(50px, 8vw, 80px);
            height: clamp(50px, 8vw, 80px);
            border-radius: 50%;
            background: radial-gradient(circle at 40% 35%, #fffde7, #ffc107);
            box-shadow: 0 0 100px #ffb347;
            z-index: 25;
            transition: all 0.5s ease-out;
            pointer-events: none;
        }

        .phase-tag {
            position: absolute;
            bottom: 10px;
            left: max(10px, 2%);
            background: #0d1b2ee0;
            color: #fad38f;
            padding: 8px 16px;
            border-radius: 40px;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            border: 1px solid #b38b51;
            backdrop-filter: blur(10px);
            z-index: 45;
            font-weight: 600;
            white-space: nowrap;
            pointer-events: none;
        }

        .angle-badge {
            position: absolute;
            top: 10px;
            left: max(10px, 2%);
            background: #2a3f5ce0;
            color: #c6ffb0;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: clamp(0.8rem, 2.2vw, 1rem);
            border: 1px solid #a5d174;
            z-index: 46;
            backdrop-filter: blur(5px);
            font-weight: 600;
            white-space: nowrap;
            pointer-events: none;
        }

        .slider-container {
            flex: 0 0 auto;
            padding: clamp(1rem, 3vh, 2rem) clamp(1rem, 4vw, 2.5rem);
            background: #102132;
            border-bottom: 1px solid #5f7da5;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            color: #ecdbaa;
            margin-bottom: 10px;
            font-size: clamp(0.8rem, 2vw, 1.1rem);
            flex-wrap: wrap;
            gap: 5px;
        }

        input[type=range] {
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, #1d3048, #456a97, #c9b078, #9e7a55, #1f2d3f);
            border-radius: 20px;
            -webkit-appearance: none;
            appearance: none;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: clamp(24px, 5vw, 28px);
            height: clamp(24px, 5vw, 28px);
            background: #faecc6;
            border-radius: 50%;
            border: 3px solid #d8a547;
            box-shadow: 0 0 20px #ffd58c;
            cursor: pointer;
        }

        .slider-marks {
            display: flex;
            justify-content: space-between;
            padding: 8px 5px 0;
            color: #aac1e2;
            font-size: clamp(0.6rem, 1.8vw, 0.8rem);
            font-weight: 500;
            flex-wrap: wrap;
            gap: 3px;
        }

        .info-section {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            flex: 1;
            min-height: 0;
            overflow: hidden;
        }

        .info-card {
            flex: 2;
            min-width: 280px;
            height: 100%;
            overflow-y: auto;
            padding: clamp(1rem, 3vh, 2rem) clamp(1rem, 3vw, 2.2rem);
            background: #101f30f5;
        }

        .stage-title {
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            color: #ffdfa7;
            line-height: 1.3;
            word-break: break-word;
        }

        .stage-sub {
            font-size: clamp(1rem, 2.5vw, 1.3rem);
            color: #c0d6fc;
            margin: 5px 0 15px 0;
            border-right: 4px solid #e0b156;
            padding-right: 12px;
            word-break: break-word;
        }

        .stage-desc {
            background: #1e3147;
            padding: clamp(1rem, 2.5vh, 1.8rem);
            border-radius: min(2rem, 5vw);
            border: 1px solid #7b98c0;
            line-height: 1.7;
            color: #eaf1ff;
            font-size: clamp(0.9rem, 2.2vw, 1.1rem);
            overflow-y: auto;
            max-height: 100%;
        }

        .scientific-note {
            background: #2a405b;
            padding: 6px 15px;
            border-radius: 30px;
            display: inline-block;
            margin: 8px 0;
            color: #ebffb0;
            font-size: clamp(0.85rem, 2vw, 1rem);
            border: 1px solid #b3d96b;
        }

        .quran-ref {
            background: #33553f;
            padding: 10px 15px;
            border-radius: 20px;
            border-right: 6px solid #ecd67a;
            margin-top: 12px;
            color: #fff0bf;
            font-size: clamp(0.95rem, 2.2vw, 1.1rem);
            font-style: italic;
            line-height: 1.6;
            word-break: break-word;
        }

        .tafsir {
            background: #2d445f;
            padding: 8px 15px;
            border-radius: 15px;
            border-right: 4px solid #a7c4ff;
            margin-top: 10px;
            color: #deedff;
            font-size: clamp(0.85rem, 2vw, 1rem);
            word-break: break-word;
        }

        .phase-list-col {
            flex: 1;
            min-width: 240px;
            height: 100%;
            overflow-y: auto;
            background: #0f1d2ee0;
            border-right: 1px solid #6182ac;
            padding: clamp(1rem, 3vh, 2rem) clamp(0.8rem, 2vw, 1.5rem);
        }

        .phase-list-col h3 {
            color: #ecd396;
            font-size: clamp(1.1rem, 3vw, 1.5rem);
            border-bottom: 2px solid;
            padding-bottom: 8px;
            margin-bottom: 12px;
            word-break: break-word;
        }

        .phase-list {
            list-style: none;
            overflow-y: auto;
            max-height: calc(100% - 50px);
        }

        .phase-list li {
            padding: 8px 12px;
            margin: 5px 0;
            background: #203853;
            border-radius: 30px;
            border: 1px solid #5f82ac;
            color: #e3edff;
            cursor: pointer;
            font-size: clamp(0.8rem, 2.2vw, 0.95rem);
            word-break: break-word;
            transition: 0.1s;
        }

        .phase-list li:hover {
            background: #376694;
            border-color: #efc880;
        }

        .phase-list li.active-phase {
            background: #c8a155;
            color: #0f1a28;
            border-color: #ffe29b;
            font-weight: 700;
        }

        footer {
            flex: 0 0 auto;
            background: #0f1d2e;
            color: #9fb9df;
            padding: 10px;
            text-align: center;
            border-top: 1px solid #4d74a2;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem);
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 380px) {
            .phase-tag, .angle-badge {
                padding: 4px 8px;
            }
            .slider-marks span {
                font-size: 0.55rem;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="sky-panel" id="skyPanel">
        <div class="horizon-line"></div>
        <div class="horizon-label">ğŸ“ Ø§Ù„Ø£ÙÙ‚</div>
        <canvas id="skyCanvas" class="sky-canvas" width="1400" height="400"></canvas>
        <canvas id="starsCanvas" class="stars-canvas" width="1400" height="400"></canvas>
        <div id="sunDisk" class="celestial-body"></div>
        <div class="phase-tag" id="currentPhaseName">Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„ÙÙ„ÙƒÙŠ</div>
        <div class="angle-badge" id="currentAngleLabel">Ø²Ø§ÙˆÙŠØ©: âˆ’22Â°</div>
    </div>

    <div class="slider-container">
        <div class="slider-label">
            <span>ğŸŒ™ Ø§Ù„Ù„ÙŠÙ„</span><span>ğŸŒ… Ø§Ù„ÙØ¬Ø±</span><span>â˜€ï¸ Ø§Ù„Ø´Ø±ÙˆÙ‚</span><span>ğŸŒ‡ Ø§Ù„ØºØ±ÙˆØ¨</span><span>ğŸŒŒ Ø§Ù„Ø´ÙÙ‚</span>
        </div>
        <input type="range" id="timeSlider" min="0" max="100" value="0" step="0.5">
        <div class="slider-marks">
            <span>Ø§Ù„Ù„ÙŠÙ„</span><span>ÙØ¬Ø± ÙƒØ§Ø°Ø¨</span><span>ÙØ¬Ø± ØµØ§Ø¯Ù‚</span><span>Ø´Ø±ÙˆÙ‚</span><span>Ø¶Ø­Ù‰</span><span>ØºØ±ÙˆØ¨</span><span>Ø´ÙÙ‚</span><span>Ø§Ù„Ù„ÙŠÙ„</span>
        </div>
    </div>

    <div class="info-section">
        <div class="info-card" id="infoCard">
            <div class="stage-title" id="stageTitle">Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„ÙÙ„ÙƒÙŠ</div>
            <div class="stage-sub" id="stageSub">Astronomical Night</div>
            <div class="stage-desc" id="stageDesc"></div>
        </div>
        <div class="phase-list-col">
            <h3>ğŸ—‚ï¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</h3>
            <ul class="phase-list" id="phaseList"></ul>
        </div>
    </div>
    <footer></footer>
</div>

<script>
    // =============================================
    // Service Worker Ù…Ø­Ø¯Ø« - Ø§Ù„Ù†Ø³Ø®Ø© v2
    // =============================================
    if ('serviceWorker' in navigator) {
        // Ø£ÙˆÙ„Ø§Ù‹: Ø¥Ù„ØºØ§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Service Worker Ù‚Ø¯ÙŠÙ…
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister();
                console.log('âœ… Service Worker Ù‚Ø¯ÙŠÙ… ØªÙ… Ø¥Ù„ØºØ§Ø¤Ù‡');
            }
        }).then(function() {
            // Ø«Ø§Ù†ÙŠØ§Ù‹: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù€ Service Worker Ø§Ù„Ø¬Ø¯ÙŠØ¯
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js?v=' + Date.now()).then(reg => {
                    console.log('âœ… Service Worker Ø¬Ø¯ÙŠØ¯ ØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ù†Ø¬Ø§Ø­');
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±Ø§Ù‹
                    reg.update();
                    
                    // Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Service Worker Ø¬Ø¯ÙŠØ¯
                    reg.addEventListener('updatefound', () => {
                        const newWorker = reg.installing;
                        console.log('ğŸ”„ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Service Worker Ø¬Ø¯ÙŠØ¯');
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('âœ… Service Worker Ø¬Ø¯ÙŠØ¯ ØªÙ… ØªØ«Ø¨ÙŠØªÙ‡ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„...');
                                window.location.reload();
                            }
                        });
                    });
                }).catch(err => {
                    console.log('âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Service Worker: ', err);
                    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ø´ Ù…Ø¨Ø§Ø´Ø±Ø©
                    if ('caches' in window) {
                        caches.open('phase-cache-v3').then(cache => {
                            cache.addAll(['./', './index.html']);
                        });
                    }
                });
            });
        });
    }

    // Ø­Ø°Ù Ø§Ù„ÙƒØ§Ø´ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    if ('caches' in window) {
        caches.keys().then(function(cacheNames) {
            return Promise.all(
                cacheNames.map(function(cacheName) {
                    if (cacheName.startsWith('phase-cache-') && cacheName !== 'phase-cache-v3') {
                        console.log('ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„ÙƒØ§Ø´ Ø§Ù„Ù‚Ø¯ÙŠÙ…:', cacheName);
                        return caches.delete(cacheName);
                    }
                })
            );
        });
    }

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø­Ù„ - Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø¢Ù† ÙÙŠ Ù…ÙƒØ§Ù†Ù‡Ø§ Ø§Ù„ØµØ­ÙŠØ­ Ø¯Ø§Ø®Ù„ ÙˆØµÙ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
    (function() {
        const allStages = [
            // Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ‚
            { id: 'night1', name: 'Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„ÙÙ„ÙƒÙŠ', angleRange: 'Ø£Ù‚Ù„ Ù…Ù† âˆ’18Â°', angleVal: -22, sub: 'Astronomical Night', 
              desc: 'Ø§Ù„Ø¸Ù„Ø§Ù… Ø§Ù„ØªØ§Ù… Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø§Ù„Ø´Ù…Ø³ ØªØ­Øª Ø§Ù„Ø£ÙÙ‚ Ø¨Ø£ÙƒØ«Ø± Ù…Ù† 18Â°. ØªØ¸Ù‡Ø± Ø§Ù„Ù†Ø¬ÙˆÙ… Ø¨ÙˆØ¶ÙˆØ­ Ø´Ø¯ÙŠØ¯.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³: âˆ’22Â° ØªØ­Øª Ø§Ù„Ø£ÙÙ‚',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ù„ÙÙ‘ÙŠÙ’Ù„Ù Ø¥ÙØ°ÙØ§ ÙŠÙØºÙ’Ø´ÙÙ‰Ù° ï´¾ [Ø§Ù„Ù„ÙŠÙ„:1]',
              tafsir: 'ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ù…ÙŠ: ÙŠØ¹Ù†ÙŠ Ø­ÙŠÙ† ÙŠØºØ·ÙŠ Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø±.',
              gradient: ['#010314','#0b1223','#172337'], star: 1.0, sunColor: 'transparent', sunY: 20 },

            // Ø§Ù„Ø´ÙÙ‚ Ø§Ù„ÙÙ„ÙƒÙŠ
            { id: 'astroTwilight', name: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„ÙÙ„ÙƒÙŠ Ø§Ù„ØµØ¨Ø§Ø­ÙŠ', angleRange: 'âˆ’18Â° Ø¥Ù„Ù‰ âˆ’12Â°', angleVal: -15, sub: 'Astronomical Twilight', 
              desc: 'Ø¶ÙˆØ¡ Ø®Ø§ÙØª Ø¬Ø¯Ø§Ù‹ØŒ Ø£ÙˆÙ„ Ø¨ÙˆØ§Ø¯Ø± Ø§Ù„Ù†Ù‡Ø§Ø±. Ù„Ø§ ØªØ²Ø§Ù„ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ø¶Ø­Ø©.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³: âˆ’15Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„ØµÙÙ‘Ø¨Ù’Ø­Ù Ø¥ÙØ°ÙØ§ Ø£ÙØ³Ù’ÙÙØ±Ù ï´¾ [Ø§Ù„Ù…Ø¯Ø«Ø±:34]',
              tafsir: 'Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„ØµØ§Ø¯Ù‚ (Ø¹): "Ø£Ø³ÙØ± Ø§Ù„ØµØ¨Ø­ Ø¥Ø°Ø§ Ø£Ø¶Ø§Ø¡ ÙˆØªØ¨ÙŠÙ†".',
              gradient: ['#09172b','#1f314a','#3b5172'], star: 0.95, sunColor: '#e6d2a0', sunY: 35 },

            // Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø¨Ø­Ø±ÙŠ
            { id: 'nauticalTwilight', name: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø¨Ø­Ø±ÙŠ Ø§Ù„ØµØ¨Ø§Ø­ÙŠ', angleRange: 'âˆ’12Â° Ø¥Ù„Ù‰ âˆ’6Â°', angleVal: -9, sub: 'Nautical Twilight', 
              desc: 'Ø§Ù„Ø£ÙÙ‚ ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ù„Ø¸Ù‡ÙˆØ±ØŒ ÙŠÙ…ÙƒÙ† ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø­Ø± Ø¹Ù† Ø§Ù„Ø³Ù…Ø§Ø¡. Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù…Ø§ Ø²Ø§Ù„Øª Ù…Ø±Ø¦ÙŠØ©.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³: âˆ’9Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ù’ÙÙØ¬Ù’Ø±Ù ï´¾ [Ø§Ù„ÙØ¬Ø±:1]',
              tafsir: 'Ù‚Ø§Ù„ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø± (Ø¹): "Ø§Ù„ÙØ¬Ø± Ù‡Ùˆ Ø§Ù„ØµØ¨Ø­ØŒ ÙˆÙ‡Ùˆ Ø§Ù„Ø®ÙŠØ· Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø§Ù„Ù…Ø¹ØªØ±Ø¶".',
              gradient: ['#1f3150','#3e5f83','#6794bc'], star: 0.7, sunColor: '#fdebb3', sunY: 48 },

            // Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ù…Ø¯Ù†ÙŠ
            { id: 'civilTwilight', name: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ù…Ø¯Ù†ÙŠ Ø§Ù„ØµØ¨Ø§Ø­ÙŠ', angleRange: 'âˆ’6Â° Ø¥Ù„Ù‰ 0Â°', angleVal: -3, sub: 'Civil Twilight', 
              desc: 'Ø¥Ø¶Ø§Ø¡Ø© ÙˆØ§Ø¶Ø­Ø© Ù†Ø³Ø¨ÙŠØ§Ù‹ØŒ Ø£ØºÙ„Ø¨ Ø§Ù„Ù†Ø¬ÙˆÙ… ØªØ®ØªÙÙŠ.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³: âˆ’3Â°',
              quran: 'ï´¿ Ø­ÙØªÙÙ‘Ù‰Ù° ÙŠÙØªÙØ¨ÙÙŠÙÙ‘Ù†Ù Ù„ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø®ÙÙŠÙ’Ø·Ù Ø§Ù„Ù’Ø£ÙØ¨Ù’ÙŠÙØ¶Ù Ù…ÙÙ†Ù Ø§Ù„Ù’Ø®ÙÙŠÙ’Ø·Ù Ø§Ù„Ù’Ø£ÙØ³Ù’ÙˆÙØ¯Ù Ù…ÙÙ†Ù Ø§Ù„Ù’ÙÙØ¬Ù’Ø±Ù ï´¾ [Ø§Ù„Ø¨Ù‚Ø±Ø©:187]',
              tafsir: 'ØªÙØ³ÙŠØ± Ù†ÙˆØ± Ø§Ù„Ø«Ù‚Ù„ÙŠÙ†: Ø§Ù„Ø®ÙŠØ· Ø§Ù„Ø£Ø¨ÙŠØ¶ Ù‡Ùˆ Ø§Ù„ÙØ¬Ø± Ø§Ù„ØµØ§Ø¯Ù‚ØŒ ÙˆØ§Ù„Ø£Ø³ÙˆØ¯ Ù‡Ùˆ Ø³ÙˆØ§Ø¯ Ø§Ù„Ù„ÙŠÙ„.',
              gradient: ['#5982b0','#8eb9dd','#c5e2ff'], star: 0.2, sunColor: '#ffdc99', sunY: 60 },

            // Ø§Ù„ÙØ¬Ø± Ø§Ù„ÙƒØ§Ø°Ø¨
            { id: 'falseDawn', name: 'Ø§Ù„ÙØ¬Ø± Ø§Ù„ÙƒØ§Ø°Ø¨', angleRange: 'âˆ’5Â° Ø¥Ù„Ù‰ âˆ’3Â° (Ø¹Ù…ÙˆØ¯ÙŠ)', angleVal: -4, sub: 'False Dawn', 
              desc: 'Ø¶ÙˆØ¡ Ø¹Ù…ÙˆØ¯ÙŠ ÙƒØ°Ù†Ø¨ Ø§Ù„Ø³Ø±Ø­Ø§Ù†. Ù„Ø§ ÙŠÙØ¹ØªØ¯ Ø¨Ù‡ Ø´Ø±Ø¹Ø§Ù‹.', 
              scientific: 'Ø¸Ø§Ù‡Ø±Ø© ØºØ¨Ø§Ø± ÙƒÙˆÙ†ÙŠ',
              quran: 'Ø¹Ù† Ø£Ù…ÙŠØ± Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ† (Ø¹): "Ù‡Ùˆ Ø§Ù„ÙØ¬Ø± Ø§Ù„ÙƒØ§Ø°Ø¨ ÙƒØ°Ù†Ø¨ Ø§Ù„Ø³Ø±Ø­Ø§Ù†"',
              tafsir: 'ÙÙŠ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø´ÙŠØ¹Ø©: Ø§Ù„ÙØ¬Ø± Ø§Ù„ÙƒØ§Ø°Ø¨ Ù„Ø§ ÙŠØ­Ø±Ù… Ø§Ù„Ø·Ø¹Ø§Ù….',
              gradient: ['#446c8c','#6e9ac0','#aac9ed'], star: 0.1, sunColor: '#ffddb0', sunY: 55 },

            // Ø§Ù„ÙØ¬Ø± Ø§Ù„ØµØ§Ø¯Ù‚
            { id: 'trueDawn', name: 'Ø§Ù„ÙØ¬Ø± Ø§Ù„ØµØ§Ø¯Ù‚', angleRange: 'âˆ’2Â° Ø¥Ù„Ù‰ +1Â° Ø£ÙÙ‚ÙŠ', angleVal: 0, sub: 'True Dawn', 
              desc: 'Ø¶ÙˆØ¡ Ø£Ø¨ÙŠØ¶ Ø£ÙÙ‚ÙŠ ÙŠÙ†ØªØ´Ø± ÙÙŠ Ø§Ù„Ø£ÙÙ‚ Ø§Ù„Ø´Ø±Ù‚ÙŠ. Ø¨Ø¯Ø§ÙŠØ© ÙˆÙ‚Øª ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ ØªØ­Øª Ø§Ù„Ø£ÙÙ‚ Ø¨Ù€ 0.5Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ù’ÙÙØ¬Ù’Ø±Ù * ÙˆÙÙ„ÙÙŠÙØ§Ù„Ù Ø¹ÙØ´Ù’Ø±Ù ï´¾ [Ø§Ù„ÙØ¬Ø±:1-2]',
              tafsir: 'Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„ØµØ§Ø¯Ù‚ (Ø¹): "Ø§Ù„ÙØ¬Ø± Ù‡Ùˆ Ø§Ù„Ø®ÙŠØ· Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø§Ù„Ù…Ø¹ØªØ±Ø¶". (Ø§Ù„ÙƒØ§ÙÙŠ)',
              gradient: ['#86b5da','#c9e1f7','#f6f9ff'], star: 0.01, sunColor: '#ffe5a3', sunY: 70 },

            // Ø§Ù„Ø¥Ø³ÙØ§Ø±
            { id: 'ishfar', name: 'Ø§Ù„Ø¥Ø³ÙØ§Ø±', angleRange: '+1Â° Ø¥Ù„Ù‰ +3Â°', angleVal: 2, sub: 'Ishfar', 
              desc: 'Ø§Ø²Ø¯ÙŠØ§Ø¯ Ø§Ù„Ø¶ÙˆØ¡ Ø¨Ø¹Ø¯ Ø§Ù„ÙØ¬Ø±ØŒ ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø¤ÙŠØ©.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³: +2Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„ØµÙÙ‘Ø¨Ù’Ø­Ù Ø¥ÙØ°ÙØ§ ØªÙÙ†ÙÙÙÙ‘Ø³Ù ï´¾ [Ø§Ù„ØªÙƒÙˆÙŠØ±:18]',
              tafsir: 'Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø·Ø¨Ø§Ø·Ø¨Ø§Ø¦ÙŠ: Ø§Ù„ØªÙ†ÙØ³ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¶ÙˆØ¡.',
              gradient: ['#add3f0','#ebf5fe','#ffffff'], star: 0, sunColor: '#ffdb8b', sunY: 85 },

            // Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø±ÙˆÙ‚
            { id: 'preSunrise', name: 'Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø±ÙˆÙ‚', angleRange: 'Ø£Ù‚Ù„ Ù…Ù† +6Â°', angleVal: 4, sub: 'Just before sunrise', 
              desc: 'Ø§Ù„Ø³Ù…Ø§Ø¡ Ù…Ø¶ÙŠØ¦Ø©ØŒ Ù‚Ø±Øµ Ø§Ù„Ø´Ù…Ø³ Ù„Ù… ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ 4Â° ØªØ­Øª Ø§Ù„Ø£ÙÙ‚',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ø´ÙÙ‘Ù…Ù’Ø³Ù ÙˆÙØ¶ÙØ­ÙØ§Ù‡ÙØ§ ï´¾ [Ø§Ù„Ø´Ù…Ø³:1]',
              tafsir: 'Ø§Ù„Ø¶Ø­Ù‰: Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ù…Ø³.',
              gradient: ['#f7cf96','#fdedc3','#ffffff'], star: 0, sunColor: '#fec267', sunY: 100 },

            // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ø±ÙˆÙ‚
            { id: 'sunriseStart', name: 'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ø±ÙˆÙ‚', angleRange: '0Â°', angleVal: 0.2, sub: 'Sunrise start', 
              desc: 'Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„Ù‚Ø±Øµ Ø§Ù„Ø´Ù…Ø³ ÙŠÙ„Ø§Ù…Ø³ Ø§Ù„Ø£ÙÙ‚.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ù…Ø³ +0.2Â°',
              quran: 'ï´¿ Ø­ÙØªÙÙ‘Ù‰Ù° Ù…ÙØ·Ù’Ù„ÙØ¹Ù Ø§Ù„Ù’ÙÙØ¬Ù’Ø±Ù ï´¾ [Ø§Ù„Ù‚Ø¯Ø±:5]',
              tafsir: 'Ø£ÙŠ ÙˆÙ‚Øª Ø·Ù„ÙˆØ¹ Ø§Ù„ÙØ¬Ø±.',
              gradient: ['#fec77e','#ffeab5','#fffcf0'], star: 0, sunColor: '#fdb64b', sunY: 108 },

            // Ø§Ù„Ø´Ø±ÙˆÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„
            { id: 'fullSunrise', name: 'Ø§Ù„Ø´Ø±ÙˆÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„', angleRange: '+0.5Â° Ø¥Ù„Ù‰ +2Â°', angleVal: 1, sub: 'Full sunrise', 
              desc: 'Ø®Ø±ÙˆØ¬ Ù‚Ø±Øµ Ø§Ù„Ø´Ù…Ø³ ÙƒØ§Ù…Ù„Ø§Ù‹ØŒ Ù†Ù‡Ø§ÙŠØ© ÙˆÙ‚Øª Ø§Ù„ÙØ¬Ø±.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ 1Â° ÙÙˆÙ‚ Ø§Ù„Ø£ÙÙ‚',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ø¶ÙÙ‘Ø­ÙÙ‰Ù° ï´¾ [Ø§Ù„Ø¶Ø­Ù‰:1]',
              tafsir: 'Ø£ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø± ÙƒÙ„Ù‡.',
              gradient: ['#fed896','#fff2d4','#ffffff'], star: 0, sunColor: '#fcaa35', sunY: 115 },

            // Ø§Ù„Ø¶Ø­Ù‰ Ø§Ù„Ù…Ø¨ÙƒØ±
            { id: 'duhaEarly', name: 'Ø§Ù„Ø¶Ø­Ù‰ Ø§Ù„Ù…Ø¨ÙƒØ±', angleRange: '+5Â° Ø¥Ù„Ù‰ +10Â°', angleVal: 8, sub: 'Early Duha', 
              desc: 'Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±ÙˆÙ‚ Ø¨Ù€ 15â€“20 Ø¯Ù‚ÙŠÙ‚Ø©.', 
              scientific: 'Ø§Ø±ØªÙØ§Ø¹ 8Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ø¶ÙÙ‘Ø­ÙÙ‰Ù° ï´¾',
              tafsir: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰ Ù…Ù† Ø§Ù„Ù†ÙˆØ§ÙÙ„.',
              gradient: ['#ffe3ad','#fff9e6','#ffffff'], star: 0, sunColor: '#ffbb4a', sunY: 140 },

            // Ø§Ù„Ø¶Ø­Ù‰
            { id: 'duha', name: 'Ø§Ù„Ø¶Ø­Ù‰', angleRange: '+15Â° Ø¥Ù„Ù‰ +25Â°', angleVal: 20, sub: 'Duha', 
              desc: 'Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ù…Ø³ ÙˆØ§Ø²Ø¯ÙŠØ§Ø¯ Ø§Ù„Ø­Ø±Ø§Ø±Ø©.', 
              scientific: 'Ø§Ø±ØªÙØ§Ø¹ 20Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ø¶ÙÙ‘Ø­ÙÙ‰Ù° * ÙˆÙØ§Ù„Ù„ÙÙ‘ÙŠÙ’Ù„Ù Ø¥ÙØ°ÙØ§ Ø³ÙØ¬ÙÙ‰Ù° ï´¾ [Ø§Ù„Ø¶Ø­Ù‰:1-2]',
              tafsir: 'Ø£Ù‚Ø³Ù… Ø§Ù„Ù„Ù‡ Ø¨Ø§Ù„Ø¶Ø­Ù‰.',
              gradient: ['#c3ddf5','#f5edc7','white'], star: 0, sunColor: '#ffc561', sunY: 190 },

            // Ø§Ù„Ø§ØµÙØ±Ø§Ø±
            { id: 'yellowing', name: 'Ø§Ù„Ø§ØµÙØ±Ø§Ø±', angleRange: '+5Â° Ø¥Ù„Ù‰ +3Â°', angleVal: 4, sub: 'Yellowing', 
              desc: 'Ù„ÙˆÙ† Ø§Ù„Ø´Ù…Ø³ ÙŠÙ…ÙŠÙ„ Ù„Ù„Ø§ØµÙØ±Ø§Ø±.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ 4Â° ÙÙˆÙ‚ Ø§Ù„Ø£ÙÙ‚',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ø´ÙÙ‘ÙÙÙ‚Ù ï´¾',
              tafsir: 'Ø§Ù„Ø´ÙÙ‚: Ø§Ù„Ø­Ù…Ø±Ø©.',
              gradient: ['#e3b185','#f5cf9c','#fee6b6'], star: 0, sunColor: '#f5b342', sunY: 150 },

            // Ø§Ù„Ø§Ø­Ù…Ø±Ø§Ø±
            { id: 'reddening', name: 'Ø§Ù„Ø§Ø­Ù…Ø±Ø§Ø±', angleRange: '+3Â° Ø¥Ù„Ù‰ +1Â°', angleVal: 2, sub: 'Reddening', 
              desc: 'Ø§Ù„Ø³Ù…Ø§Ø¡ ØªÙ…ÙŠÙ„ Ù„Ù„Ø£Ø­Ù…Ø±.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ 2Â°',
              quran: 'ï´¿ ÙÙÙ„ÙØ§ Ø£ÙÙ‚Ù’Ø³ÙÙ…Ù Ø¨ÙØ§Ù„Ø´ÙÙ‘ÙÙÙ‚Ù ï´¾',
              tafsir: 'Ø§Ù„Ø´ÙÙ‚ Ù‡Ùˆ Ø§Ù„Ø­Ù…Ø±Ø©.',
              gradient: ['#c7603a','#dd8f55','#f0b97c'], star: 0, sunColor: '#d9670e', sunY: 125 },

            // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØºØ±ÙˆØ¨
            { id: 'sunsetStart', name: 'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØºØ±ÙˆØ¨', angleRange: '0Â°', angleVal: 0.2, sub: 'Sunset start', 
              desc: 'Ù‚Ø±Øµ Ø§Ù„Ø´Ù…Ø³ ÙŠÙ„Ø§Ù…Ø³ Ø§Ù„Ø£ÙÙ‚.', 
              scientific: 'Ø²Ø§ÙˆÙŠØ© 0.2Â°',
              quran: 'ï´¿ Ù„ÙØ¯ÙÙ„ÙÙˆÙƒÙ Ø§Ù„Ø´ÙÙ‘Ù…Ù’Ø³Ù ï´¾',
              tafsir: 'Ø¯Ù„ÙˆÙƒ Ø§Ù„Ø´Ù…Ø³: Ù…ÙŠÙ„Ù‡Ø§ Ù„Ù„ØºØ±ÙˆØ¨.',
              gradient: ['#b44f2e','#cf7847','#e2a269'], star: 0.03, sunColor: '#cb6015', sunY: 108 },

            // Ø§Ù„ØºØ±ÙˆØ¨ Ø§Ù„ÙƒØ§Ù…Ù„
            { id: 'fullSunset', name: 'Ø§Ù„ØºØ±ÙˆØ¨ Ø§Ù„ÙƒØ§Ù…Ù„', angleRange: 'âˆ’0.5Â°', angleVal: -0.5, sub: 'Full sunset', 
              desc: 'Ø§Ø®ØªÙØ§Ø¡ Ù‚Ø±Øµ Ø§Ù„Ø´Ù…Ø³. Ø¨Ø¯Ø§ÙŠØ© ÙˆÙ‚Øª Ø§Ù„Ù…ØºØ±Ø¨.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ âˆ’0.5Â°',
              quran: 'ï´¿ Ù‚ÙØ¨Ù’Ù„Ù ØºÙØ±ÙÙˆØ¨ÙÙ‡ÙØ§ ï´¾',
              tafsir: 'ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨.',
              gradient: ['#7b4237','#a15d44','#bd8257'], star: 0.15, sunColor: '#aa4713', sunY: 90 },

            // Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±
            { id: 'redTwilight', name: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±', angleRange: 'âˆ’4Â° Ø¥Ù„Ù‰ âˆ’6Â°', angleVal: -5, sub: 'Red twilight', 
              desc: 'Ø­Ù…Ø±Ø© ÙÙŠ Ø§Ù„ØºØ±Ø¨ØŒ ØªØ¨Ø¯Ø£ Ø§Ù„Ù†Ø¬ÙˆÙ… Ø¨Ø§Ù„Ø¸Ù‡ÙˆØ±.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ âˆ’5Â°',
              quran: 'ï´¿ ÙÙÙ„ÙØ§ Ø£ÙÙ‚Ù’Ø³ÙÙ…Ù Ø¨ÙØ§Ù„Ø´ÙÙ‘ÙÙÙ‚Ù ï´¾',
              tafsir: 'Ø¹Ù† Ø£Ø¨ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ (Ø¹): "Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø­Ù…Ø±Ø©".',
              gradient: ['#572f39','#7a4d47','#9f6b56'], star: 0.45, sunColor: '#933f17', sunY: 70 },

            // Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø£Ø¨ÙŠØ¶
            { id: 'whiteTwilight', name: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø£Ø¨ÙŠØ¶', angleRange: 'âˆ’7Â° Ø¥Ù„Ù‰ âˆ’10Â°', angleVal: -9, sub: 'White twilight', 
              desc: 'Ø¶ÙˆØ¡ Ø£Ø¨ÙŠØ¶ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ù…Ø±Ø©ØŒ Ø§Ù„Ø³Ù…Ø§Ø¡ ØªØºÙ…Ù‚.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ âˆ’9Â°',
              quran: 'ï´¿ Ø§Ù„Ù’Ø®ÙÙŠÙ’Ø·Ù Ø§Ù„Ù’Ø£ÙØ¨Ù’ÙŠÙØ¶Ù ï´¾',
              tafsir: 'Ø§Ù„Ø´ÙÙ‚ Ø§Ù„Ø£Ø¨ÙŠØ¶.',
              gradient: ['#303d5a','#4f6382','#7087aa'], star: 0.7, sunColor: '#b0a38e', sunY: 50 },

            // Ø§Ù„ØºØ³Ù‚
            { id: 'ghasaq', name: 'Ø§Ù„ØºØ³Ù‚', angleRange: 'âˆ’11Â° Ø¥Ù„Ù‰ âˆ’15Â°', angleVal: -13, sub: 'Ghasaq', 
              desc: 'Ø§Ø´ØªØ¯Ø§Ø¯ Ø§Ù„Ø¸Ù„Ù…Ø©ØŒ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù„ÙŠÙ„.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ âˆ’13Â°',
              quran: 'ï´¿ Ø¥ÙÙ„ÙÙ‰Ù° ØºÙØ³ÙÙ‚Ù Ø§Ù„Ù„ÙÙ‘ÙŠÙ’Ù„Ù ï´¾',
              tafsir: 'ØºØ³Ù‚ Ø§Ù„Ù„ÙŠÙ„: Ø¸Ù„Ø§Ù…Ù‡.',
              gradient: ['#172236','#253b54','#2e4868'], star: 0.9, sunColor: 'transparent', sunY: 30 },

            // Ø§Ù„Ù„ÙŠÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
            { id: 'night2', name: 'Ø§Ù„Ù„ÙŠÙ„ Ø§Ù„ÙÙ„ÙƒÙŠ', angleRange: 'Ø£Ù‚Ù„ Ù…Ù† âˆ’18Â°', angleVal: -22, sub: 'Astronomical night', 
              desc: 'Ø¸Ù„Ø§Ù… ØªØ§Ù…ØŒ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ø¶Ø­Ø© Ø¬Ø¯Ø§Ù‹.', 
              scientific: 'Ø§Ù„Ø´Ù…Ø³ ØªØ­Øª âˆ’18Â°',
              quran: 'ï´¿ ÙˆÙØ§Ù„Ù„ÙÙ‘ÙŠÙ’Ù„Ù Ø¥ÙØ°ÙØ§ Ø³ÙØ¬ÙÙ‰Ù° ï´¾',
              tafsir: 'Ø³Ø¬Ù‰: Ø³ÙƒÙ†.',
              gradient: ['#010514','#0c1425','#182337'], star: 1.0, sunColor: 'transparent', sunY: 20 }
        ];

        const skyCanvas = document.getElementById('skyCanvas');
        const starsCanvas = document.getElementById('starsCanvas');
        const sunDisk = document.getElementById('sunDisk');
        const phaseNameSpan = document.getElementById('currentPhaseName');
        const angleSpan = document.getElementById('currentAngleLabel');
        const stageTitle = document.getElementById('stageTitle');
        const stageSub = document.getElementById('stageSub');
        const stageDesc = document.getElementById('stageDesc');
        const phaseListEl = document.getElementById('phaseList');
        const timeSlider = document.getElementById('timeSlider');

        let currentStageIndex = 0;
        const starsCtx = starsCanvas.getContext('2d');

        // Ù†Ø¬ÙˆÙ… Ù†Ø§Ø¹Ù…Ø© Ø¬Ø¯Ø§Ù‹ØŒ ØµØºÙŠØ±Ø©ØŒ Ø¨Ø¹ÙŠØ¯Ø©ØŒ Ø´Ø¨Ù‡ Ø®Ø§ÙØªØ©
        function drawStars(opacity) {
            const w = starsCanvas.width;
            const h = starsCanvas.height;
            starsCtx.clearRect(0,0,w,h);
            if (opacity <= 0.01) return;

            // Ù†Ø¬ÙˆÙ… Ø®Ù„ÙÙŠØ© Ù†Ø§Ø¹Ù…Ø© Ø¬Ø¯Ø§Ù‹ (ØªÙƒØ§Ø¯ Ù„Ø§ ØªØ±Ù‰)
            for (let i = 0; i < 600; i++) {
                let x = Math.random() * w;
                let y = Math.random() * h * 0.9;
                let size = 0.3 + Math.random() * 0.7;
                let faint = 0.3 + Math.random() * 0.5;
                starsCtx.fillStyle = `rgba(255, 245, 220, ${opacity * faint * 0.6})`;
                starsCtx.beginPath();
                starsCtx.arc(x, y, size, 0, 2 * Math.PI);
                starsCtx.fill();
            }

            // Ù†Ø¬ÙˆÙ… Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø¨Ø¹Ø¯ (Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ø§Ù‹ ÙˆÙ„ÙƒÙ† Ù„Ø§ ØªØ²Ø§Ù„ Ù†Ø§Ø¹Ù…Ø©)
            for (let i = 0; i < 200; i++) {
                let x = Math.random() * w;
                let y = Math.random() * h * 0.85;
                let size = 0.6 + Math.random() * 1.0;
                starsCtx.fillStyle = `rgba(255, 255, 230, ${opacity * 0.7})`;
                starsCtx.beginPath();
                starsCtx.arc(x, y, size, 0, 2 * Math.PI);
                starsCtx.fill();
            }

            // Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„Ø®Ø§ÙØªØ© Ø¬Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„
            for (let i = 0; i < 150; i++) {
                let x = Math.random() * w;
                let y = 100 + Math.random() * 200;
                let size = 0.2 + Math.random() * 0.5;
                starsCtx.fillStyle = `rgba(230, 240, 255, ${opacity * 0.4})`;
                starsCtx.beginPath();
                starsCtx.arc(x, y, size, 0, 2 * Math.PI);
                starsCtx.fill();
            }
        }

        function drawSky(index) {
            const stage = allStages[index];
            if (!stage) return;

            phaseNameSpan.innerText = stage.name;
            angleSpan.innerText = `Ø²Ø§ÙˆÙŠØ©: ${stage.angleVal}Â°`;
            stageTitle.innerText = stage.name;
            stageSub.innerText = stage.sub;

            let descHtml = `<p>${stage.desc}</p><div class="scientific-note">${stage.scientific}</div>`;
            if (stage.quran) descHtml += `<div class="quran-ref">${stage.quran}</div>`;
            if (stage.tafsir) descHtml += `<div class="tafsir">ğŸ“˜ ØªÙØ³ÙŠØ±: ${stage.tafsir}</div>`;
            stageDesc.innerHTML = descHtml;

            // Ø±Ø³Ù… ØªØ¯Ø±Ø¬ Ø§Ù„Ø³Ù…Ø§Ø¡
            const ctx = skyCanvas.getContext('2d');
            const w = skyCanvas.width, h = skyCanvas.height;
            ctx.clearRect(0,0,w,h);
            const grd = ctx.createLinearGradient(0,0,0,h);
            grd.addColorStop(0, stage.gradient[0]);
            grd.addColorStop(0.5, stage.gradient[1]);
            grd.addColorStop(1, stage.gradient[2]);
            ctx.fillStyle = grd;
            ctx.fillRect(0,0,w,h);

            // Ø±Ø³Ù… Ø§Ù„Ù†Ø¬ÙˆÙ…
            drawStars(stage.star);

            // ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ù…Ø³
            if (stage.sunColor === 'transparent') {
                sunDisk.style.opacity = '0';
                sunDisk.style.boxShadow = 'none';
            } else {
                sunDisk.style.opacity = '1';
                sunDisk.style.background = `radial-gradient(circle at 40% 30%, #fffce6, ${stage.sunColor})`;
                sunDisk.style.boxShadow = '0 0 100px #ffae42';
                sunDisk.style.bottom = stage.sunY + 'px';
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
            document.querySelectorAll('.phase-list li').forEach(li => {
                const idx = li.dataset.index;
                if (parseInt(idx) === index) li.classList.add('active-phase');
                else li.classList.remove('active-phase');
            });
        }

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        allStages.forEach((stage, idx) => {
            const li = document.createElement('li');
            li.textContent = `${stage.name} (${stage.angleRange})`;
            li.dataset.index = idx;
            li.addEventListener('click', () => {
                currentStageIndex = idx;
                timeSlider.value = (idx / (allStages.length-1)) * 100;
                drawSky(idx);
            });
            phaseListEl.appendChild(li);
        });

        // Ø±Ø¨Ø· Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
        timeSlider.addEventListener('input', (e) => {
            const val = parseFloat(e.target.value);
            const indexFloat = (val / 100) * (allStages.length - 1);
            let index = Math.round(indexFloat);
            if (index < 0) index = 0;
            if (index >= allStages.length) index = allStages.length - 1;
            if (index !== currentStageIndex) {
                currentStageIndex = index;
                drawSky(index);
            }
        });

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø±Ø¶
        drawSky(0);
        timeSlider.value = 0;
    })();
</script>
</body>
</html>
